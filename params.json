{"name":"atvjs","tagline":"Blazing fast Apple TV application development using pure JavaScript","body":"# atvjs\r\nBlazing fast Apple TV application development using pure JavaScript.\r\n\r\n<!-- MarkdownTOC depth=4 autolink=true autoanchor=true bracket=round -->\r\n\r\n- [Philosophy](#philosophy)\r\n- [What's included](#whats-included)\r\n- [Getting Started](#getting-started)\r\n- [Basic Examples](#basic-examples)\r\n\t- [Creating Pages](#creating-pages)\r\n\t- [Adding TVML styles to your page](#adding-tvml-styles-to-your-page)\r\n\t- [Fetching data from a remote source](#fetching-data-from-a-remote-source)\r\n\t- [Creating links to other pages](#creating-links-to-other-pages)\r\n- [Advanced Topics](#advanced-topics)\r\n\t- [Event Handling](#event-handling)\r\n\t- [Custom options while navigation](#custom-options-while-navigation)\r\n\t- [Creating Menu Page](#creating-menu-page)\r\n\t- [Application initialization using configuration](#application-initialization-using-configuration)\r\n- [Sample Code](#sample-code)\r\n- [Useful Links](#useful-links)\r\n- [Contributions](#contributions)\r\n- [License](#license)\r\n\r\n<!-- /MarkdownTOC -->\r\n\r\n<a name=\"philosophy\"></a>\r\n### Philosophy\r\n\r\n##### What?\r\nThis is a super simple framework for blazing fast [Apple TV](https://developer.apple.com/tvos/) application development using pure JavaScript. It relies on the [tvOS](https://developer.apple.com/tvos/) provided [TVML](https://developer.apple.com/library/prerelease/tvos/documentation/LanguagesUtilities/Conceptual/ATV_Template_Guide/) and [TVJS](https://developer.apple.com/library/prerelease/tvos/documentation/TVMLJS/Reference/TVJSFrameworkReference/) for [Apple TV development](https://developer.apple.com/library/tvos/documentation/General/Conceptual/AppleTV_PG/). However this framework does most of the heavy lifting for you and lets you concentrate on your application logic without worrying about the hassles of complicated architecture for Apple TV development. Build your Apple TV application the same way how you are used to building your SPA applications in JavaScript and let the framework handle the rest for you.\r\n\r\n##### Why?\r\nThe existing application architecture and sample code provided by apple for building the Apple TV applications using TVML and TVJS appears to be very immature (no offense Apple) and feels more like the web applications of the 90s where each of the page loads separately by sending the request to the back-end which generates your application page markup based on the user interaction and sends the new page back to the browser. This is okay if we were still in the 90s but feels so dumb in this era where we are used to building SPAs with REST APIs and back-end is used just as a data interaction point. Here comes *atvjs* that bridges the gap and lets you use the same architecture that, we as front-end developers, have embraced over the years.\r\n\r\n##### How?\r\nYou simply create your pages (views) by passing a bunch of configurations (name of the page, template function, url etc) with your desired data (you can either populate data manually using your own ajax requests or pass a url configuration to fetch data from your server). Once the page is created, it is uniquely identifiable using the name. You can navigate to your page anytime in your application using the same name.\r\n\r\n<a name=\"whats-included\"></a>\r\n### What's included\r\n- Page, Menu and Modal Creation and Navigation `ATV.Page.create`, `ATV.Menu.create`, `ATV.Navigation.navigate`, `ATV.Navigation.navigateToMenuPage`, `ATV.Navigation.presentModal`\r\n- TVML styling capabilities (both global as well as individual page level)\r\n- Event handling (both global and for individual pages and elements)\r\n- Application level persistent data storage using localStorage `ATV.Settings.set`,  `ATV.Settings.get`, `ATV.Settings.remove`\r\n- Ajax library using JavaScript Promises `ATV.Ajax`, `ATV.Ajax.get`, `ATV.Ajax.post`, `ATV.Ajax.put`, `ATV.Ajax.del`\r\n- Application level publish/subscribe using [PubSubJS](https://github.com/mroderick/PubSubJS) `ATV.subscribe`, `ATV.publish`, `ATV.unsubscribe`\r\n- Application initialization/reload using simple configurations `ATV.start`, `ATV.reload`\r\n- Global error handling\r\n- JavaScript `Promise` and other ES6 Features Polyfill using [babel](https://babeljs.io/docs/usage/polyfill/)\r\n- [lodash](https://lodash.com/) library as `ATV._`\r\n\r\n<a name=\"getting-started\"></a>\r\n### Getting Started\r\n`atvjs` is defined as a `UMD` and available as an [npm package](https://www.npmjs.com/package/atvjs). You can either import it as a dependency or download it independently and include in your project.\r\n\r\n```\r\n$ npm install --save atvjs\r\n```\r\n\r\nYou'll then be able to use it as a dependency with your favorite module system.\r\n\r\n```javascript\r\nimport ATV from 'atvjs';\r\n// or\r\nvar ATV = require('atvjs');\r\n```\r\n\r\nOr if you have downloaded a copy of `atvjs`, pull the script inside your application after launch.\r\n\r\n```javascript\r\nfunction onEvaluate(success) {\r\n\tif (!success) {\r\n\t\t// application failed to load\r\n\t}\r\n}\r\n\r\nApp.onLaunch = function(options) {\r\n\tvar baseurl = options.BASEURL;\r\n\tApp.launchOptions = options;\r\n\tevaluateScripts([`${baseurl}atv.min.js`, `${baseurl}app.js`], onEvaluate);\r\n};\r\n\r\n// then in your app.js you will have the instance of ATV library available\r\n// you can contain your entire application code inside app.js\r\n```\r\n\r\n<a name=\"basic-examples\"></a>\r\n### Basic Examples\r\n\r\n<a name=\"creating-pages\"></a>\r\n#### Creating Pages\r\nCreate pages in your application using the page factory. You will then be able to navigate to these pages using the name of the page.\r\n\r\n```javascript\r\nATV.Page.create({\r\n\tname: 'home',\r\n\t// use a template function from your favourite templating engine\r\n\t// or pass a raw template function\r\n\ttemplate(data) {\r\n\t\treturn `<document>\r\n\t\t\t\t\t<alertTemplate>\r\n\t\t\t\t\t\t<title>${data.title}</title>\r\n\t\t\t\t\t\t<description>${data.description}</description>\r\n\t\t\t\t\t</alertTemplate>\r\n\t\t\t\t</document>`;\r\n\t},\r\n\t// pass some raw data to be applied\r\n\t// or a data function that returns the data\r\n\tdata: {\r\n\t\ttitle: 'Homepage',\r\n\t\tdescription: 'This is my super awesome homepage created using atvjs.'\r\n\t}\r\n});\r\n\r\n// later in your application you can do something like below to navigate to the page\r\nATV.Navigation.navigate('home');\r\n```\r\n\r\n<a name=\"adding-tvml-styles-to-your-page\"></a>\r\n#### Adding TVML styles to your page\r\nYou need to define your [TVML styles](https://developer.apple.com/library/tvos/documentation/LanguagesUtilities/Conceptual/ATV_Template_Guide/ITMLStyles.html) as string and pass that as a configuration to your page. It will automatically be added to your page document in the runtime when your page is being navigated.\r\n\r\n```javascript\r\nlet myPageStyles = `\r\n.text-bold {\r\n\tfont-weight: bold;\r\n}\r\n.text-white {\r\n\tcolor: rgb(255, 255, 255);\r\n}\r\n`;\r\n\r\nATV.Page.create({\r\n\tname: 'home',\r\n\tstyle: myPageStyles,\r\n\ttemplate: your_template_function,\r\n\tdata: your_data\r\n});\r\n```\r\n\r\n<a name=\"fetching-data-from-a-remote-source\"></a>\r\n#### Fetching data from a remote source\r\nYou can fetch `JSON` content from the remote api by setting the `url` configuration. The data will be fetched using ajax and will be applied to the provided template. You can even run some transformations on the data before applying it to the template\r\n\r\n```javascript\r\nATV.Page.create({\r\n\tname: 'home',\r\n\turl: 'path/to/your/api/that/returns/json',\r\n\ttemplate: your_template_function\r\n});\r\n\r\n// or you can transform the response before applying to your template\r\nATV.Page.create({\r\n\tname: 'home',\r\n\turl: 'path/to/your/api/that/returns/json',\r\n\ttemplate: your_template_function,\r\n\tdata(response) {\r\n\t\t// transform your response before applying to your template\r\n\t\tlet transformedData = someTransformationOfResponse(response);\r\n\t\treturn transformedData;\r\n\t}\r\n});\r\n```\r\n\r\n<a name=\"creating-links-to-other-pages\"></a>\r\n#### Creating links to other pages\r\nYou can setup links to other pages directly in your [TVML markup](https://developer.apple.com/library/prerelease/tvos/documentation/LanguagesUtilities/Conceptual/ATV_Template_Guide/) by setting the `data-href-page` attribute with the value of your page name that you want to link to. The framework will take care of the navigation for you. You can also pass options to your page (see topic *[Custom options while navigation](#custom-options-while-navigation)* for details) by setting up the `data-href-page-options` attribute with a JSON value.\r\n\r\n```\r\n<document>\r\n\t<alertTemplate>\r\n\t\t<title>Example for creating links to other pages</title>\r\n\t\t<description>Select an option</description>\r\n\t\t<button data-href-page=\"homepage\">\r\n\t\t\t<text>Go To Homepage</text>\r\n\t\t</button>\r\n\t\t<button data-href-page=\"login\" data-href-page-options='{\"username\": \"emadalam\", \"password\": \"123456\"}'>\r\n\t\t\t<text>Login</text>\r\n\t\t</button>\r\n\t</alertTemplate>\r\n</document>\r\n```\r\n\r\n<a name=\"advanced-topics\"></a>\r\n### Advanced Topics\r\n\r\n<a name=\"event-handling\"></a>\r\n#### Event Handling\r\nYou can define the list of events and their respective handlers as key-value pairs. The handler will be invoked in the current object context and you can access all the methods and properties that exist on the object.\r\n\r\n```javascript\r\nATV.Page.create({\r\n\tname: 'mypage',\r\n\ttemplate: your_template_function,\r\n\tdata: your_data,\r\n\tevents: {\r\n\t\tselect: 'onSelect',\r\n\t\thighlight: 'onHighlight'\r\n\t},\r\n\t// method invoked in the scope of the current object and\r\n\t// 'this' will be bound to the object at runtime\r\n\t// so you can easily access methods and properties and even modify them at runtime\r\n\tonSelect(e) {\r\n\t\tlet element = e.target;\r\n\t\tlet someCheckForElementType = element.getAttribute('data-my-attribute');\r\n\t\tlet someOtherCheckForElementType = element.getAttribute('data-my-other-attribute');\r\n\r\n\t\tif (someCheckForElementType) {\r\n\t\t\tthis.doSomethingOnElementType1();\r\n\t\t}\r\n\r\n\t\tif (someOtherCheckForElementType) {\r\n\t\t\tthis.doSomethingOnElementType2();\r\n\t\t}\r\n\t},\r\n\tonHighlight(e) {\r\n\t\t// same as above\r\n\t},\r\n\tdoSomethingOnElementType1() {\r\n\t\t// some awesome action\r\n\t},\r\n\tdoSomethingOnElementType2() {\r\n\t\t// some other awesome action\r\n\t}\r\n});\r\n```\r\n\r\n<a name=\"custom-options-while-navigation\"></a>\r\n#### Custom options while navigation\r\nYou can pass your application state/logic to make reusable dynamic pages that renders a new page each time the navigation is performed. This can be achieved by setting a `ready` method in the configuration that accepts 3 parameters, `options`, `resolve` and `reject`. These parameters are automatically passed to the ready method whenever a navigation to this page is performed. The navigation relies on [JavaScript Promises](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise), so you'll have to call resolve/reject method after performing your logic.\r\n\r\n```javascript\r\nATV.Page.create({\r\n\tname: 'login',\r\n\ttemplate: your_template_function,\r\n\t// the ready method is called each time the navigation to this page is performed and\r\n\t// the options object is passed to the method at runtime\r\n\t// use options to pass any dynamic state of your application\r\n\t// you can then use this state and populate your data (either using custom ajax or some other logic)\r\n\t// once the data is populated, call the resolve method with the data or reject method for failure\r\n\tready(options, resolve, reject) {\r\n\t\tlet data = {\r\n\t\t\tusername: options.username,\r\n\t\t\tpassword: options.password\r\n\t\t};\r\n\t\t// perform ajax to get the data\r\n\t\t// the ajax method in the library returns an instance of the Promise object\r\n\t\tATV\r\n\t\t\t.Ajax\r\n\t\t\t.post('someURL', {data: data})\r\n\t\t\t.then((xhr) => {\r\n\t\t\t\t// xhr succeeded\r\n\t\t\t\tlet response = xhr.response;\r\n\t\t\t\t// call resolve with the data that will be applied to the template\r\n\t\t\t\t// you can even call resolve with false to skip navigation\r\n\t\t\t\tresolve({\r\n\t\t\t\t\tname: response.name,\r\n\t\t\t\t\tmessage: response.message\r\n\t\t\t\t});\r\n\t\t\t}, (xhr) => {\r\n\t\t\t\t// xhr failed\r\n\t\t\t\tlet response = xhr.response;\r\n\t\t\t\treject({\r\n\t\t\t\t\tstatus: xhr.status,\r\n\t\t\t\t\tmessage: response.message\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n});\r\n// later in your application\r\nATV.Navigation.navigate('login', {username: 'emadalam', password: '123456'});\r\n```\r\n\r\n<a name=\"creating-menu-page\"></a>\r\n#### Creating Menu Page\r\nThe way menu template is designed in TVJS, you need to first create a menu template with your list of menu items. You then need to create individual documents and set one for each of the menu item. The resultant menu template then needs to be parsed and converted into a document which you can push on the navigation stack. Sounds fancy? NO WAYS! Here comes atvjs for your rescue. All you need is a menu configuration with your items list and the pages that you want to associate. The rest will be taken care by the framework. You can then navigate to the menu page using the provided navigation method. SWEET!\r\n\r\n*Note: Menu page is singleton, meaning you cannot create multiple menu pages. It seems logical, as an application at any given state, will have a single menu listing in its entire lifespan.*\r\n\r\n```javascript\r\n// create your pages\r\nlet SearchPage = ATV.Page.create({/* page configurations */});\r\nlet HomePage = ATV.Page.create({/* page configurations */});\r\nlet MoviesPage = ATV.Page.create({/* page configurations */});\r\nlet TVShowsPage = ATV.Page.create({/* page configurations */});\r\n\r\n// create menu page\r\nATV.Menu.create({\r\n\t// any attributes that you want to set on the root level menuBar element of TVML\r\n\tattributes: {},\r\n\t// array of menu item configurations\r\n\titems: [{\r\n\t\tid: 'search',\r\n\t\tname: 'Search',\r\n\t\tpage: SearchPage\r\n\t}, {\r\n\t\tid: 'homepage',\r\n\t\tname: 'Home',\r\n\t\tpage: HomePage,\r\n\t\tattributes: {\r\n\t\t\tautoHighlight: true // auto highlight on navigate\r\n\t\t}\r\n\t}, {\r\n\t\tid: 'movies',\r\n\t\tname: 'Movies',\r\n\t\tpage: MoviesPage\r\n\t}, {\r\n\t\tid: 'tvshows',\r\n\t\tname: 'TV Shows',\r\n\t\tpage: TVShowsPage\r\n\t}]\r\n});\r\n\r\n// later in your application\r\nATV.Navigation.navigateToMenuPage();\r\n```\r\n\r\n<a name=\"application-initialization-using-configuration\"></a>\r\n#### Application initialization using configuration\r\nYou can easily initialize your application by passing all the configurations at once.\r\n\r\n```javascript\r\n// create your pages\r\nlet SearchPage = ATV.Page.create({/* page configurations */});\r\nlet HomePage = ATV.Page.create({/* page configurations */});\r\nlet MoviesPage = ATV.Page.create({/* page configurations */});\r\nlet TVShowsPage = ATV.Page.create({/* page configurations */});\r\nlet LoginPage = ATV.Page.create({/* page configurations */});\r\n\r\n// template functions\r\nconst loaderTpl = (data) => `<document>\r\n\t<loadingTemplate>\r\n\t\t<activityIndicator>\r\n\t\t\t<title>${data.message}</title>\r\n\t\t</activityIndicator>\r\n\t</loadingTemplate>\r\n</document>`;\r\n\r\nconst errorTpl = (data) => `<document>\r\n\t<descriptiveAlertTemplate>\r\n\t\t<title>${data.title}</title>\r\n\t\t<description>${data.message}</description>\r\n\t</descriptiveAlertTemplate>\r\n</document>`;\r\n\r\n// Global TVML styles\r\nlet globalStyles = `\r\n.text-bold {\r\n\tfont-weight: bold;\r\n}\r\n.text-white {\r\n\tcolor: rgb(255, 255, 255);\r\n}\r\n.dark-background-color {\r\n\tbackground-color: #091a2a;\r\n}\r\n.button {\r\n\tbackground-color: rgba(0, 0, 0, 0.1);\r\n\ttv-tint-color: rgba(0, 0, 0, 0.1);\r\n}\r\n`;\r\n\r\n// start your application by passing configurations\r\nATV.start({\r\n\tstyle: globalStyles,\r\n\tmenu: {\r\n\t\tattributes: {},\r\n\t\titems: [{\r\n\t\t\tid: 'search',\r\n\t\t\tname: 'Search',\r\n\t\t\tpage: SearchPage\r\n\t\t}, {\r\n\t\t\tid: 'homepage',\r\n\t\t\tname: 'Home',\r\n\t\t\tpage: HomePage,\r\n\t\t\tattributes: {\r\n\t\t\t\tautoHighlight: true // auto highlight on navigate\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tid: 'movies',\r\n\t\t\tname: 'Movies',\r\n\t\t\tpage: MoviesPage\r\n\t\t}, {\r\n\t\t\tid: 'tvshows',\r\n\t\t\tname: 'TV Shows',\r\n\t\t\tpage: TVShowsPage\r\n\t\t}]\r\n\t},\r\n\ttemplates: {\r\n\t\t// loader template\r\n\t\tloader: loaderTpl,\r\n\t\t// global error template\r\n\t\terror: errorTpl,\r\n\t\t// xhr status based error messages\r\n\t\tstatus: {\r\n\t\t\t'404': () => errorTpl({\r\n\t\t\t\ttitle: '404',\r\n\t\t\t\tmessage: 'The given page was not found'\r\n\t\t\t}),\r\n\t\t\t'500': () => errorTpl({\r\n\t\t\t\ttitle: '500',\r\n\t\t\t\tmessage: 'An unknown error occurred, please try again later!'\r\n\t\t\t})\r\n\t\t}\r\n\t},\r\n\t// global event handlers that will be called for each of the pages\r\n\thandlers: {\r\n\t\tselect: {\r\n\t\t\tglobalSelecthandler(e) {\r\n\t\t\t\tlet element = e.target;\r\n\t\t\t\tlet someElementTypeCheck = element.getAttribute('data-my-attribute');\r\n\r\n\t\t\t\tif (elementTypeCheck) {\r\n\t\t\t\t\t// perform action\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tonLaunch(options) {\r\n\t\t// navigate to menu page\r\n\t\tATV.Navigation.navigateToMenuPage();\r\n\t\t// or you can navigate to previously created page\r\n\t\t// ATV.Navigation.navigate('login');\r\n\t}\r\n});\r\n```\r\n\r\n<a name=\"sample-code\"></a>\r\n### Sample Code\r\nYou can find a port of the original TVML Catalog sample code [re-written using atvjs](https://github.com/emadalam/tvml-catalog-using-atvjs).\r\n\r\n<a name=\"useful-links\"></a>\r\n### Useful Links\r\n\r\n- Apple TV Development - [tvOS](https://developer.apple.com/tvos/), [TVJS](https://developer.apple.com/library/tvos/documentation/TVMLJS/Reference/TVJSFrameworkReference/index.html) and [TVML](https://developer.apple.com/library/prerelease/tvos/documentation/LanguagesUtilities/Conceptual/ATV_Template_Guide/index.html)\r\n- Building tvOS Applications - [Tutorial 1](http://josecasanova.com/blog/how-to-build-a-tvos-application-for-apple-tv-tutorial/) and [Tutorial 2](http://www.raywenderlich.com/114886/beginning-tvos-development-with-tvml-tutorial)\r\n- [JavaScript Promises](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)\r\n- [ES6 Features](http://es6-features.org)\r\n- [Babel](https://babeljs.io/)\r\n\r\n<a name=\"contributions\"></a>\r\n### Contributions\r\n\r\n- Fork the project\r\n- Commit your enhancements and bug fixes\r\n- Create a pull request describing the changes\r\n\r\n<a name=\"license\"></a>\r\n### License\r\natvjs is released under the [MIT License](http://opensource.org/licenses/MIT).\r\n","google":"UA-44640221-1","note":"Don't delete this file! It's used internally to help with page regeneration."}